"use strict";(self.webpackChunksoapbox=self.webpackChunksoapbox||[]).push([[24],{1538:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var a=n(2125),i=n(1406),o=(n(12),n(29),n(9),n(0),n(54),n(5),n(1)),s=n(2131),r=n(1407),c=n(1418),l=n(150),d=n(1415),u=n(3),f=n(2),m=n(2115),v=n(2116),p=n(432),g=n(2117),Z={house:v,street:g,secondary:g,zone:m,city:m,administrative:m},h=function(e){var t=e.id,n=(0,u.CG)((function(e){return e.locations.get(t)}));return n?(0,i.Z)(f.Ug,{alignItems:"center",space:2},void 0,(0,i.Z)(f.JO,{src:Z[n.type]||p}),(0,i.Z)(f.Kq,{},void 0,(0,i.Z)(f.xv,{},void 0,n.description),(0,i.Z)(f.xv,{size:"xs",theme:"muted"},void 0,[n.street,n.locality,n.country].filter((function(e){return null==e?void 0:e.trim()})).join(" · ")))):null},_=n(670),M=n(739),C=n(202),b=n.n(C),x=n(637),y=n(59),w=function(){},k=(0,s.vU)({placeholder:{id:"location_search.placeholder",defaultMessage:"Find an address"}}),E=function(e){var t=e.onSelected,s=(0,r.Z)(),c=(0,u.TL)(),d=(0,o.useState)((0,M.OrderedSet)()),f=(0,a.Z)(d,2),m=f[0],v=f[1],p=(0,o.useRef)(new AbortController),g=(0,o.useState)(""),Z=(0,a.Z)(g,2),C=Z[0],E=Z[1],T=function(){return!(C.length>0)},S=(0,o.useCallback)(b()((function(e){c((0,l.fL)(e,p.current.signal)).then((function(e){var t=e.map((function(e){return e.origin_id}));v((0,M.OrderedSet)(t))})).catch(w)}),900,{leading:!0,trailing:!0}),[]);return(0,o.useEffect)((function(){""===C&&v((0,M.OrderedSet)())}),[C]),(0,i.Z)("div",{className:"search"},void 0,(0,i.Z)(x.Z,{className:"rounded-full",placeholder:s.formatMessage(k.placeholder),value:C,onChange:function(e){var t=e.target;p.current.abort(),p.current=new AbortController,S(t.value),E(t.value)},suggestions:m.toList(),onSuggestionsFetchRequested:w,onSuggestionsClearRequested:w,onSuggestionSelected:function(e,n,a){"string"==typeof a&&t(a)},searchTokens:[],onKeyDown:function(e){var t,n;"Escape"===e.key&&(null===(t=document.querySelector(".ui"))||void 0===t||null===(n=t.parentElement)||void 0===n||n.focus())},renderSuggestion:h}),(0,i.Z)("div",{role:"button",tabIndex:0,className:"search__icon",onClick:function(e){e.preventDefault(),T()||E("")}},void 0,(0,i.Z)(y.Z,{src:n(192),className:(0,_.default)("svg-icon--search",{active:T()})}),(0,i.Z)(y.Z,{src:n(723),className:(0,_.default)("svg-icon--backspace",{active:!T()}),"aria-label":s.formatMessage(k.placeholder)})))},T=n(821),S=n(85),N=n(1421),q=n(94),I=n(82),D=(n(74),n(24),function(e){var t,a=e.disabled,s=e.onSelectFile,r=(0,o.useRef)(null),l=null===(t=(0,u.CG)((function(e){return e.instance.configuration.getIn(["media_attachments","supported_mime_types"])})))||void 0===t?void 0:t.filter((function(e){return e.startsWith("image/")}));return(0,i.Z)(f.Ug,{className:"h-full w-full cursor-pointer text-primary-500 dark:text-accent-blue",space:3,alignItems:"center",justifyContent:"center",element:"label"},void 0,(0,i.Z)(y.Z,{src:n(1030),className:"h-7 w-7",onClick:function(){var e;null===(e=r.current)||void 0===e||e.click()}}),(0,i.Z)(f.xv,{size:"sm",theme:"primary",weight:"semibold",transform:"uppercase"},void 0,(0,i.Z)(c.Z,{id:"compose_event.upload_banner",defaultMessage:"Upload photo"})),o.createElement("input",{ref:r,type:"file",accept:l&&l.toArray().join(","),onChange:function(e){var t;null!==(t=e.target.files)&&void 0!==t&&t.length&&s(e.target.files)},disabled:a,className:"hidden"}))}),z=(0,s.vU)({eventNamePlaceholder:{id:"compose_event.fields.name_placeholder",defaultMessage:"Name"},eventDescriptionPlaceholder:{id:"compose_event.fields.description_placeholder",defaultMessage:"Description"},eventStartTimePlaceholder:{id:"compose_event.fields.start_time_placeholder",defaultMessage:"Event begins on…"},eventEndTimePlaceholder:{id:"compose_event.fields.end_time_placeholder",defaultMessage:"Event ends on…"},resetLocation:{id:"compose_event.reset_location",defaultMessage:"Reset location"},edit:{id:"compose_event.tabs.edit",defaultMessage:"Edit details"},pending:{id:"compose_event.tabs.pending",defaultMessage:"Manage requests"},authorize:{id:"compose_event.participation_requests.authorize",defaultMessage:"Authorize"},reject:{id:"compose_event.participation_requests.reject",defaultMessage:"Reject"},confirm:{id:"confirmations.delete.confirm",defaultMessage:"Delete"},cancelEditing:{id:"confirmations.cancel_editing.confirm",defaultMessage:"Cancel editing"}}),G=function(e){var t=e.eventId,n=e.id,a=e.participationMessage,o=(0,r.Z)(),s=(0,u.TL)();return(0,i.Z)(S.Z,{id:n,note:a||void 0,action:(0,i.Z)(f.Ug,{space:2},void 0,(0,i.Z)(f.zx,{theme:"secondary",size:"sm",text:o.formatMessage(z.authorize),onClick:function(){s((0,l.Qq)(t,n))}}),(0,i.Z)(f.zx,{theme:"danger",size:"sm",text:o.formatMessage(z.reject),onClick:function(){s((0,l.my)(t,n))}}))})},U=function(e){var t,s,m=e.onClose,v=(0,r.Z)(),p=(0,u.TL)(),g=(0,o.useState)("edit"),h=(0,a.Z)(g,2),_=h[0],M=h[1],C=(0,u.CG)((function(e){return e.compose_event.banner})),b=(0,u.CG)((function(e){return e.compose_event.is_uploading})),x=(0,u.CG)((function(e){return e.compose_event.name})),y=(0,u.CG)((function(e){return e.compose_event.status})),w=(0,u.CG)((function(e){return e.compose_event.start_time})),k=(0,u.CG)((function(e){return e.compose_event.end_time})),S=(0,u.CG)((function(e){return e.compose_event.approval_required})),U=(0,u.CG)((function(e){return e.compose_event.location})),O=(0,u.CG)((function(e){return e.compose_event.id})),j=(0,u.CG)((function(e){return e.compose_event.is_submitting})),F=function(e){p((0,l.CF)(e))},P=function(e){p((0,l.V_)(e))},A=function(e){p((0,l.JP)(e))},K=(0,u.CG)((function(e){var t;return null===(t=e.user_lists.event_participation_requests.get(O))||void 0===t?void 0:t.items}));return(0,o.useEffect)((function(){O&&p((0,l.AK)(O))}),[]),t="edit"===_?(0,i.Z)(f.l0,{},void 0,(0,i.Z)(f.cw,{labelText:(0,i.Z)(c.Z,{id:"compose_event.fields.banner_label",defaultMessage:"Event banner"})},void 0,(0,i.Z)("div",{className:"dark:sm:shadow-inset relative flex h-24 items-center justify-center overflow-hidden rounded-lg bg-primary-100 text-primary-500 dark:bg-gray-800 dark:text-white sm:h-32 sm:shadow"},void 0,C?o.createElement(o.Fragment,null,(0,i.Z)("img",{className:"h-full w-full object-cover",src:C.url,alt:""}),(0,i.Z)(f.hU,{className:"absolute right-2 top-2",src:n(83),onClick:function(){p((0,l.Qi)())}})):(0,i.Z)(D,{disabled:b,onSelectFile:function(e){p((0,l.ZK)(e[0],v))}}))),(0,i.Z)(f.cw,{labelText:(0,i.Z)(c.Z,{id:"compose_event.fields.name_label",defaultMessage:"Event name"})},void 0,(0,i.Z)(f.II,{type:"text",placeholder:v.formatMessage(z.eventNamePlaceholder),value:x,onChange:function(e){var t=e.target;p((0,l.ux)(t.value))}})),(0,i.Z)(f.cw,{labelText:(0,i.Z)(c.Z,{id:"compose_event.fields.description_label",defaultMessage:"Event description"}),hintText:(0,i.Z)(c.Z,{id:"compose_event.fields.description_hint",defaultMessage:"Markdown syntax is supported"})},void 0,(0,i.Z)(f.gx,{autoComplete:"off",placeholder:v.formatMessage(z.eventDescriptionPlaceholder),value:y,onChange:function(e){var t=e.target;p((0,l.y4)(t.value))}})),(0,i.Z)(f.cw,{labelText:(0,i.Z)(c.Z,{id:"compose_event.fields.location_label",defaultMessage:"Event location"})},void 0,U?U&&(0,i.Z)(f.Ug,{className:"h-[38px] text-gray-700 dark:text-gray-500",alignItems:"center",space:2},void 0,(0,i.Z)(f.JO,{src:Z[U.type]||n(432)}),(0,i.Z)(f.Kq,{className:"grow"},void 0,(0,i.Z)(f.xv,{},void 0,U.description),(0,i.Z)(f.xv,{theme:"muted",size:"xs"},void 0,[U.street,U.locality,U.country].filter((function(e){return null==e?void 0:e.trim()})).join(" · "))),(0,i.Z)(f.hU,{title:v.formatMessage(z.resetLocation),src:n(83),onClick:function(){return A(null)}})):(0,i.Z)(E,{onSelected:A})),(0,i.Z)(f.cw,{labelText:(0,i.Z)(c.Z,{id:"compose_event.fields.start_time_label",defaultMessage:"Event start date"})},void 0,(0,i.Z)(q.Z,{fetchComponent:I.Mt},void 0,(function(e){return(0,i.Z)(e,{showTimeSelect:!0,dateFormat:"MMMM d, yyyy h:mm aa",timeIntervals:15,wrapperClassName:"react-datepicker-wrapper",placeholderText:v.formatMessage(z.eventStartTimePlaceholder),filterDate:N.isCurrentOrFutureDate,selected:w,onChange:F})}))),(0,i.Z)(f.Ug,{alignItems:"center",space:2},void 0,(0,i.Z)(f.ZD,{checked:!!k,onChange:function(e){var t=e.target;p((0,l.hY)(t.checked))}}),(0,i.Z)(f.xv,{tag:"span",theme:"muted"},void 0,(0,i.Z)(c.Z,{id:"compose_event.fields.has_end_time",defaultMessage:"The event has end date"}))),k&&(0,i.Z)(f.cw,{labelText:(0,i.Z)(c.Z,{id:"compose_event.fields.end_time_label",defaultMessage:"Event end date"})},void 0,(0,i.Z)(q.Z,{fetchComponent:I.Mt},void 0,(function(e){return(0,i.Z)(e,{showTimeSelect:!0,dateFormat:"MMMM d, yyyy h:mm aa",timeIntervals:15,wrapperClassName:"react-datepicker-wrapper",placeholderText:v.formatMessage(z.eventEndTimePlaceholder),filterDate:N.isCurrentOrFutureDate,selected:k,onChange:P})}))),!O&&(0,i.Z)(f.Ug,{alignItems:"center",space:2},void 0,(0,i.Z)(f.ZD,{checked:S,onChange:function(e){var t=e.target;p((0,l.cU)(t.checked))}}),(0,i.Z)(f.xv,{tag:"span",theme:"muted"},void 0,(0,i.Z)(c.Z,{id:"compose_event.fields.approval_required",defaultMessage:"I want to approve participation requests manually"})))):K?(0,i.Z)(f.Kq,{space:3},void 0,K.size>0?K.map((function(e){var t=e.account,n=e.participation_message;return(0,i.Z)(G,{eventId:O,id:t,participationMessage:n},t)})):(0,i.Z)(c.Z,{id:"empty_column.event_participant_requests",defaultMessage:"There are no pending event participation requests."})):(0,i.Z)(f.$j,{}),(0,i.Z)(f.u_,{title:O?(0,i.Z)(c.Z,{id:"navigation_bar.compose_event",defaultMessage:"Manage event"}):(0,i.Z)(c.Z,{id:"navigation_bar.create_event",defaultMessage:"Create new event"}),confirmationAction:"edit"===_?function(){p((0,l.X_)())}:void 0,confirmationText:O?(0,i.Z)(c.Z,{id:"compose_event.update",defaultMessage:"Update"}):(0,i.Z)(c.Z,{id:"compose_event.create",defaultMessage:"Create"}),confirmationDisabled:j,onClose:function(){p((function(e,t){(0,T.ox)(t().compose_event)?e((0,d.h7)("CONFIRM",{icon:n(103),heading:O?(0,i.Z)(c.Z,{id:"confirmations.cancel_event_editing.heading",defaultMessage:"Cancel event editing"}):(0,i.Z)(c.Z,{id:"confirmations.delete_event.heading",defaultMessage:"Delete event"}),message:O?(0,i.Z)(c.Z,{id:"confirmations.cancel_event_editing.message",defaultMessage:"Are you sure you want to cancel editing this event? All changes will be lost."}):(0,i.Z)(c.Z,{id:"confirmations.delete_event.message",defaultMessage:"Are you sure you want to delete this event?"}),confirm:v.formatMessage(z.confirm),onConfirm:function(){e((0,d.Mr)("COMPOSE_EVENT")),e((0,l.ZB)())}})):m("COMPOSE_EVENT")}))}},void 0,(0,i.Z)(f.Kq,{space:2},void 0,O&&(s=[{text:v.formatMessage(z.edit),action:function(){return M("edit")},name:"edit"},{text:v.formatMessage(z.pending),action:function(){return M("pending")},name:"pending"}],(0,i.Z)(f.mQ,{items:s,activeItem:_})),t))}},2115:function(e,t,n){e.exports=n.p+"packs/icons/building-community-c07bf903.svg"},2116:function(e,t,n){e.exports=n.p+"packs/icons/home-2-c7fe02f7.svg"},2117:function(e,t,n){e.exports=n.p+"packs/icons/road-c2c24223.svg"}}]);
//# sourceMappingURL=compose_event_modal-9ba11ab223ce86c4114d.chunk.js.map