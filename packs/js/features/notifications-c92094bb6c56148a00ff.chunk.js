"use strict";(self.webpackChunksoapbox=self.webpackChunksoapbox||[]).push([[61],{1305:function(e,t,o){o.r(t),o.d(t,{default:function(){return B}});var i=o(2120),a=(o(14),o(0),o(16),o(9),o(28),o(31),o(91),o(5),o(663)),n=o(828),s=o(82),r=o.n(s),l=o(1),c=o(2121),u=o(2122),d=o(2143),f=o(221),m=o(387),p=o(69),g=o(388),v=o(1548),Z=o(53),h=o(2),b=o(333),M=o(557),_=o(2155),y=function(){return(0,i.Z)("div",{className:"bg-white px-4 py-6 dark:bg-primary-900 sm:p-6"},void 0,(0,i.Z)("div",{className:"w-full animate-pulse"},void 0,(0,i.Z)("div",{className:"mb-2"},void 0,(0,i.Z)(_.Z,{minLength:20,maxLength:20})),(0,i.Z)("div",{},void 0,(0,i.Z)(h.Ug,{space:3,alignItems:"center"},void 0,(0,i.Z)("div",{className:"shrink-0"},void 0,(0,i.Z)(b.Z,{size:48})),(0,i.Z)("div",{className:"min-w-0 flex-1"},void 0,(0,i.Z)(M.Z,{minLength:3,maxLength:25})))),(0,i.Z)("div",{className:"mt-4"},void 0,(0,i.Z)(_.Z,{minLength:5,maxLength:120}))))},w=l.memo(y),j=o(3),k=(o(4),o(61)),x=(0,c.vU)({all:{id:"notifications.filter.all",defaultMessage:"All"},mentions:{id:"notifications.filter.mentions",defaultMessage:"Mentions"},favourites:{id:"notifications.filter.favourites",defaultMessage:"Likes"},boosts:{id:"notifications.filter.boosts",defaultMessage:"Reposts"},polls:{id:"notifications.filter.polls",defaultMessage:"Poll results"},follows:{id:"notifications.filter.follows",defaultMessage:"Follows"},emoji_reacts:{id:"notifications.filter.emoji_reacts",defaultMessage:"Emoji reacts"},statuses:{id:"notifications.filter.statuses",defaultMessage:"Updates from people you follow"}}),C=function(){var e=(0,u.Z)(),t=(0,j.TL)(),a=(0,j.rV)(),n=(0,j.hz)(),s=a.getIn(["notifications","quickFilter","active"]),r=a.getIn(["notifications","quickFilter","advanced"]),l=function(e){return function(){return t((0,m.Tv)(e))}},c=[{text:e.formatMessage(x.all),action:l("all"),name:"all"}];return r?(c.push({text:(0,i.Z)(k.Z,{src:o(305)}),title:e.formatMessage(x.mentions),action:l("mention"),name:"mention"}),c.push({text:(0,i.Z)(k.Z,{src:o(396)}),title:e.formatMessage(x.favourites),action:l("favourite"),name:"favourite"}),n.emojiReacts&&c.push({text:(0,i.Z)(k.Z,{src:o(933)}),title:e.formatMessage(x.emoji_reacts),action:l("pleroma:emoji_reaction"),name:"pleroma:emoji_reaction"}),c.push({text:(0,i.Z)(k.Z,{src:o(181)}),title:e.formatMessage(x.boosts),action:l("reblog"),name:"reblog"}),c.push({text:(0,i.Z)(k.Z,{src:o(721)}),title:e.formatMessage(x.polls),action:l("poll"),name:"poll"}),c.push({text:(0,i.Z)(k.Z,{src:o(740)}),title:e.formatMessage(x.statuses),action:l("status"),name:"status"}),c.push({text:(0,i.Z)(k.Z,{src:o(257)}),title:e.formatMessage(x.follows),action:l("follow"),name:"follow"})):c.push({text:e.formatMessage(x.mentions),action:l("mention"),name:"mention"}),(0,i.Z)(h.mQ,{items:c,activeItem:s})},N=o(2095),q=(o(8),o(465)),I=o(2142),L=o(2103),G=o(62),U=o(160),z=o(2139),T=o(95),S=o(86),F=o(337),R=o(41),D=o(715),E={follow:o(257),follow_request:o(257),mention:o(305),favourite:o(396),group_favourite:o(396),reblog:o(181),group_reblog:o(181),status:o(740),poll:o(721),move:o(561),"pleroma:chat_mention":o(309),"pleroma:emoji_reaction":o(925),user_approved:o(257),update:o(327),"pleroma:event_reminder":o(1551),"pleroma:participation_request":o(483),"pleroma:participation_accepted":o(483)},P=(0,c.Em)({id:"notification.name",defaultMessage:"{link}{others}"}),H=(0,c.vU)({follow:{id:"notification.follow",defaultMessage:"{name} followed you"},follow_request:{id:"notification.follow_request",defaultMessage:"{name} has requested to follow you"},mention:{id:"notification.mentioned",defaultMessage:"{name} mentioned you"},favourite:{id:"notification.favourite",defaultMessage:"{name} liked your post"},group_favourite:{id:"notification.group_favourite",defaultMessage:"{name} liked your group post"},reblog:{id:"notification.reblog",defaultMessage:"{name} reposted your post"},group_reblog:{id:"notification.group_reblog",defaultMessage:"{name} reposted your group post"},status:{id:"notification.status",defaultMessage:"{name} just posted"},poll:{id:"notification.poll",defaultMessage:"A poll you have voted in has ended"},move:{id:"notification.move",defaultMessage:"{name} moved to {targetName}"},"pleroma:chat_mention":{id:"notification.pleroma:chat_mention",defaultMessage:"{name} sent you a message"},"pleroma:emoji_reaction":{id:"notification.pleroma:emoji_reaction",defaultMessage:"{name} reacted to your post"},user_approved:{id:"notification.user_approved",defaultMessage:"Welcome to {instance}!"},update:{id:"notification.update",defaultMessage:"{name} edited a post you interacted with"},"pleroma:event_reminder":{id:"notification.pleroma:event_reminder",defaultMessage:"An event you are participating in starts soon"},"pleroma:participation_request":{id:"notification.pleroma:participation_request",defaultMessage:"{name} wants to join your event"},"pleroma:participation_accepted":{id:"notification.pleroma:participation_accepted",defaultMessage:"You were accepted to join the event"}}),K=function(e,t,o,a,n,s){var r=function(e){return(0,i.Z)("bdi",{},void 0,(0,i.Z)(I.rU,{className:"font-bold text-gray-800 hover:underline dark:text-gray-200",title:e.acct,to:"/@".concat(e.acct),dangerouslySetInnerHTML:{__html:e.display_name_html}}))}(o),l=e.formatMessage(P,{link:r,others:a&&a>0?(0,i.Z)(d.Z,{id:"notification.others",defaultMessage:" + {count, plural, one {# other} other {# others}}",values:{count:a-1}}):""});return e.formatMessage(H[t],{name:l,targetName:n,instance:s})},A=function(e){var t=e.hidden,o=void 0!==t&&t,a=e.onMoveUp,n=e.onMoveDown,s=(0,j.TL)(),r=(0,l.useCallback)((0,R.e4)(),[]),c=(0,j.CG)((function(t){return r(t,e.notification)})),d=(0,L.k6)(),f=(0,u.Z)(),m=(0,j.fz)(),g=c.type,v=c.account,Z=c.status,b=function(){v&&"object"===(0,N.Z)(v)&&d.push("/@".concat(v.acct))},M=(0,l.useCallback)((function(e){null==e||e.preventDefault(),v&&"object"===(0,N.Z)(v)&&s((0,G.Ck)(v))}),[v]),_=(0,l.useCallback)((function(e){Z&&"object"===(0,N.Z)(Z)&&(Z.favourited?s((0,U.m9)(Z)):s((0,U.yF)(Z)))}),[Z]),y=(0,l.useCallback)((function(e){Z&&"object"===(0,N.Z)(Z)&&s((function(t,o){var i=(0,p.Gw)(o()).get("boostModal");Z.reblogged?s((0,U.y_)(Z)):null!=e&&e.shiftKey||!i?s((0,U.UM)(Z)):s((0,z.h7)("BOOST",{status:Z,onReblog:function(e){s((0,U.UM)(e))}}))}))}),[Z]),w=(0,l.useCallback)((function(e){Z&&"object"===(0,N.Z)(Z)&&(Z.hidden?s((0,T.oK)(Z.id)):s((0,T.E1)(Z.id)))}),[Z]),x=function(){a&&a(c.id)},C=function(){n&&n(c.id)},I=c.target&&"object"===(0,N.Z)(c.target)?c.target.acct:"",P=(0,D.lG)(g)&&v&&"object"===(0,N.Z)(v)?K(f,g,v,c.total_count,I,m.title):null,A=(0,D.lG)(g)?function(e,t,o){var i=[t];return i.push(e.formatDate(o,{hour:"2-digit",minute:"2-digit",month:"short",day:"numeric"})),i.join(", ")}(f,f.formatMessage(H[g],{name:v&&"object"===(0,N.Z)(v)?v.acct:"",targetName:I}),c.created_at):"";return(0,i.Z)(q.HotKeys,{handlers:{reply:M,favourite:_,boost:y,mention:M,open:function(){Z&&"object"===(0,N.Z)(Z)&&v&&"object"===(0,N.Z)(v)?d.push("/@".concat(v.acct,"/posts/").concat(Z.id)):b()},openProfile:b,moveUp:x,moveDown:C,toggleHidden:w},"data-testid":"notification"},void 0,(0,i.Z)("div",{className:"notification focusable",tabIndex:0,"aria-label":A},void 0,(0,i.Z)("div",{className:"focusable p-4"},void 0,(0,i.Z)("div",{className:"mb-2"},void 0,(0,i.Z)(h.Ug,{alignItems:"center",space:3},void 0,(0,i.Z)("div",{className:"flex justify-end",style:{flexBasis:48}},void 0,"pleroma:emoji_reaction"===g&&c.emoji?(0,i.Z)(h.dy,{emoji:c.emoji,src:c.emoji_url||void 0,className:"h-4 w-4 flex-none"}):(0,D.lG)(g)?(0,i.Z)(k.Z,{src:E[g],className:"flex-none text-primary-600 dark:text-primary-400"}):null),(0,i.Z)("div",{className:"truncate"},void 0,(0,i.Z)(h.xv,{theme:"muted",size:"xs",truncate:!0,"data-testid":"message"},void 0,P)))),(0,i.Z)("div",{},void 0,function(){switch(g){case"follow":case"user_approved":return v&&"object"===(0,N.Z)(v)?(0,i.Z)(S.Z,{id:v.id,hidden:o,avatarSize:48}):null;case"follow_request":return v&&"object"===(0,N.Z)(v)?(0,i.Z)(S.Z,{id:v.id,hidden:o,avatarSize:48,actionType:"follow_request"}):null;case"move":return v&&"object"===(0,N.Z)(v)&&c.target&&"object"===(0,N.Z)(c.target)?(0,i.Z)(S.Z,{id:c.target.id,hidden:o,avatarSize:48}):null;case"favourite":case"group_favourite":case"mention":case"reblog":case"group_reblog":case"status":case"poll":case"update":case"pleroma:emoji_reaction":case"pleroma:event_reminder":case"pleroma:participation_accepted":case"pleroma:participation_request":return Z&&"object"===(0,N.Z)(Z)?(0,i.Z)(F.Z,{id:Z.id,hidden:o,onMoveDown:C,onMoveUp:x,avatarSize:48,contextType:"notifications",showGroup:!1}):null;default:return null}}()))))},V=(0,c.vU)({title:{id:"column.notifications",defaultMessage:"Notifications"},queue:{id:"notifications.queue_label",defaultMessage:"Click to see {count} new {count, plural, one {notification} other {notifications}}"}}),Y=(0,f.P1)([function(e){return(0,p.Gw)(e).getIn(["notifications","quickFilter","show"])},function(e){return(0,p.Gw)(e).getIn(["notifications","quickFilter","active"])},function(e){return(0,n.List)((0,p.Gw)(e).getIn(["notifications","shows"]).filter((function(e){return!e})).keys())},function(e){return e.notifications.items.toList()}],(function(e,t,o,i){return e&&"all"!==t?i.filter((function(e){return null!==e&&t===e.get("type")})):i.filterNot((function(e){return null!==e&&o.includes(e.get("type"))}))})),B=function(){var e=(0,j.TL)(),t=(0,u.Z)(),o=(0,j.rV)(),n=o.getIn(["notifications","quickFilter","show"]),s=o.getIn(["notifications","quickFilter","active"]),c=(0,j.CG)((function(e){return Y(e)})),f=(0,j.CG)((function(e){return e.notifications.isLoading})),p=(0,j.CG)((function(e){return e.notifications.hasMore})),b=(0,j.CG)((function(e){return e.notifications.totalQueuedNotificationsCount||0})),M=(0,l.useRef)(null),_=(0,l.useRef)(null),y=(0,l.useRef)(null),k=(0,l.useCallback)(r()((function(){var t=c.last();e((0,m._P)({maxId:t&&t.get("id")}))}),300,{leading:!0}),[c]),x=(0,l.useCallback)(r()((function(){e((0,m.ws)(!0))}),100),[]),N=(0,l.useCallback)(r()((function(){e((0,m.ws)(!1))}),100),[]),q=function(e){var t=c.findIndex((function(t){return null!==t&&t.get("id")===e}))-1;L(t)},I=function(e){var t=c.findIndex((function(t){return null!==t&&t.get("id")===e}))+1;L(t)},L=function(e){var t;null===(t=M.current)||void 0===t||t.scrollIntoView({index:e,behavior:"smooth",done:function(){var t=_.current,o=null==t?void 0:t.querySelector('[data-index="'.concat(e,'"] .focusable'));o&&o.focus()}})},G=function(){e((0,m.JI)())};(0,l.useEffect)((function(){return G(),e((0,m.ws)(!0)),function(){k.cancel(),x.cancel(),N.cancel(),e((0,m.ws)(!1))}}),[]);var U,z="all"===s?(0,i.Z)(d.Z,{id:"empty_column.notifications",defaultMessage:"You don't have any notifications yet. Interact with others to start the conversation."}):(0,i.Z)(d.Z,{id:"empty_column.notifications_filtered",defaultMessage:"You don't have any notifications of this type yet."}),T=n?(0,i.Z)(C,{}):null;U=f&&y.current?y.current:c.size>0||p?c.map((function(e){return(0,i.Z)(A,{notification:e,onMoveUp:q,onMoveDown:I},e.id)})):null,y.current=U;var S=l.createElement(Z.Z,{ref:M,scrollKey:"notifications",isLoading:f,showLoading:f&&0===c.size,hasMore:p,emptyMessage:z,placeholderComponent:w,placeholderCount:20,onLoadMore:k,onScrollToTop:x,onScroll:N,className:(0,a.default)({"divide-y divide-gray-200 dark:divide-primary-800 divide-solid":c.size>0,"space-y-2":0===c.size})},U);return l.createElement(h.sg,{ref:_,label:t.formatMessage(V.title),withHeader:!1},T,(0,i.Z)(v.Z,{onClick:G,count:b,message:V.queue}),(0,i.Z)(g.Z,{onRefresh:function(){return e((0,m._P)())}},void 0,S))}},1551:function(e,t,o){e.exports=o.p+"packs/icons/calendar-time-b51181b2.svg"}}]);
//# sourceMappingURL=notifications-c92094bb6c56148a00ff.chunk.js.map